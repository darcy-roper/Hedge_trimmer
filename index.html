<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Bet Hedging Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .multi-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .multi-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .legs-input {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .legs-input label {
            font-weight: 600;
            color: #555;
        }
        
        .legs-input select {
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }
        
        .outcome-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .outcome-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .outcome-card:hover {
            border-color: #667eea;
        }
        
        .outcome-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .outcome-card input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 5px;
        }
        
        .outcome-card input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .bet-return-option {
            margin-top: 15px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
            transition: all 0.3s ease;
        }
        
        .bet-return-option:hover {
            border-color: #667eea;
        }
        
        .bet-return-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .bet-return-option label {
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #555;
        }
        
        .bet-return-option input[type="checkbox"] {
            margin: 0;
            transform: scale(1.2);
        }
        
        .stake-input {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .stake-input label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .stake-input input {
            width: 200px;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1.1em;
            text-align: center;
        }
        
        .stake-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .calculate-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .results {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
        }
        
        .arbitrage-opportunity {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .strategy-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }
        
        .strategy-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .bet-amount {
            font-size: 1.3em;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 5px;
        }
        
        .potential-return {
            color: #666;
            font-size: 0.95em;
        }
        
        .summary {
            background: #f0f4f8;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .hidden {
            display: none;
        }
        
        .capital-breakdown {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .capital-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capital-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
        }
        
        .capital-item strong {
            display: block;
            color: #333;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .capital-amount {
            font-size: 1.3em;
            font-weight: 700;
            color: #667eea;
        }
        
        .allocation-sliders {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #e1e5e9;
        }
        
        .allocation-header {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }
        
        .allocation-header h4 {
            margin: 0 0 8px 0;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .allocation-subtitle {
            color: #666;
            font-size: 0.9em;
            margin: 0;
        }
        
        .slider-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin: 20px 0;
        }
        
        .slider-section {
            text-align: center;
        }
        
        .slider-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .slider-amount {
            font-size: 1.4em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .allocation-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e1e5e9;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }
        
        .allocation-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .allocation-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .slider-divider {
            width: 2px;
            height: 60px;
            background: linear-gradient(to bottom, #e1e5e9, #667eea, #e1e5e9);
            border-radius: 1px;
        }
        
        .allocation-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .allocation-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e1e5e9;
        }
        
        .allocation-percentage {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }
        
        .scenario-box {
            margin-bottom: 25px;
            border-radius: 16px;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .scenario-header {
            padding: 20px 25px 15px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }
        
        .scenario-win {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .scenario-lose {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .scenario-lose-bad {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .scenario-title {
            font-weight: 700;
            margin: 0;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .scenario-body {
            background: white;
            padding: 25px;
        }
        
        .calculation-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .calculation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 3px solid #e1e5e9;
        }
        
        .calculation-item.positive {
            background: #f0fdf4;
            border-left-color: #10b981;
        }
        
        .calculation-item.negative {
            background: #fef2f2;
            border-left-color: #ef4444;
        }
        
        .calculation-item.neutral {
            background: #f0f9ff;
            border-left-color: #3b82f6;
        }
        
        .calc-label {
            font-weight: 500;
            color: #374151;
            flex-grow: 1;
        }
        
        .calc-formula {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85em;
            color: #6b7280;
            margin: 0 15px;
            flex-shrink: 0;
        }
        
        .calc-result {
            font-weight: 700;
            font-size: 1.1em;
            min-width: 80px;
            text-align: right;
        }
        
        .calc-result.positive {
            color: #10b981;
        }
        
        .calc-result.negative {
            color: #ef4444;
        }
        
        .calc-result.neutral {
            color: #3b82f6;
        }
        
        .total-result {
            background: white;
            border: 2px solid;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-top: 15px;
        }
        
        .scenario-win .total-result {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .scenario-lose .total-result {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        .scenario-lose-bad .total-result {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        }
        
        .total-label {
            font-size: 0.9em;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .total-amount {
            font-size: 2em;
            font-weight: 800;
            margin: 0;
        }
        
        .scenario-win .total-amount {
            color: #10b981;
        }
        
        .scenario-lose .total-amount {
            color: #f59e0b;
        }
        
        .scenario-lose-bad .total-amount {
            color: #ef4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎯 Multi-Bet Hedging Calculator</h1>
        
        <div class="multi-section">
            <h3>Multi-Bet Setup</h3>
            <div class="legs-input">
                <label for="numLegs">Number of guaranteed legs:</label>
                <select id="numLegs">
                    <option value="1">1 leg</option>
                    <option value="2" selected>2 legs</option>
                    <option value="3">3 legs</option>
                    <option value="4">4 legs</option>
                    <option value="5">5 legs</option>
                </select>
            </div>
            
            <div class="outcome-section">
                <div class="outcome-card">
                    <h4>Option A (Favourite)</h4>
                    <input type="number" id="oddsA" step="0.01" min="1.01" placeholder="2.20" value="2.20">
                    <small>Multi-bet odds with favourite to win</small>
                    <div class="bet-return-option" id="returnOptionA">
                        <label>
                            <input type="checkbox" id="betReturnA">
                            Bet Return if leg fails (max $50)
                        </label>
                    </div>
                </div>
                <div class="outcome-card">
                    <h4>Option B (Underdog)</h4>
                    <input type="number" id="oddsB" step="0.01" min="1.01" placeholder="4.75" value="4.75">
                    <small>Multi-bet odds with underdog to win</small>
                    <div class="bet-return-option" id="returnOptionB">
                        <label>
                            <input type="checkbox" id="betReturnB">
                            Bet Return if leg fails (max $50)
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="stake-input">
                <label for="totalCapital">Total Capital Available ($)</label>
                <input type="number" id="totalCapital" step="0.01" min="1" placeholder="100">
                <small style="display: block; margin-top: 8px; color: #666;">
                    This will be split optimally between multi-bet and hedge positions
                </small>
            </div>
            
            <button class="calculate-btn" onclick="calculateMultiHedge()">Calculate Hedging Strategy</button>
        </div>
        
        <div id="results" class="results hidden">
            <div id="opportunityStatus"></div>
            <div id="strategy" class="strategy-grid"></div>
            
            <div id="allocationSliders" class="allocation-sliders hidden">
                <div class="allocation-header">
                    <h4>🎚️ Adjust Capital Allocation</h4>
                    <p class="allocation-subtitle">Slide to see how different allocations affect your profit/loss</p>
                </div>
                
                <div class="slider-container">
                    <div class="slider-section">
                        <div class="slider-label">Multi-Bet Amount</div>
                        <div class="slider-amount" id="multiBetSliderAmount">$0.00</div>
                        <input type="range" class="allocation-slider" id="multiBetSlider" min="0" max="100" value="60">
                    </div>
                    
                    <div class="slider-divider"></div>
                    
                    <div class="slider-section">
                        <div class="slider-label">Hedge Bet Amount</div>
                        <div class="slider-amount" id="hedgeBetSliderAmount">$0.00</div>
                        <input type="range" class="allocation-slider" id="hedgeBetSlider" min="0" max="100" value="40">
                    </div>
                </div>
                
                <div class="allocation-summary">
                    <div class="allocation-item">
                        <strong>Multi-Bet</strong>
                        <div class="allocation-percentage" id="multiBetPercentage">60%</div>
                    </div>
                    <div class="allocation-item">
                        <strong>Hedge Bet</strong>
                        <div class="allocation-percentage" id="hedgeBetPercentage">40%</div>
                    </div>
                </div>
            </div>
            
            <div id="summary" class="summary"></div>
        </div>
    </div>

    <script>
        // Global variables to store current calculation state
        let currentCalculation = null;
        
        // Handle bet return option selection
        document.getElementById('betReturnA').addEventListener('change', function() {
            updateBetReturnVisual('A');
        });
        
        document.getElementById('betReturnB').addEventListener('change', function() {
            updateBetReturnVisual('B');
        });
        
        // Handle slider interactions
        document.getElementById('multiBetSlider').addEventListener('input', function() {
            updateAllocationFromSlider('multi');
        });
        
        document.getElementById('hedgeBetSlider').addEventListener('input', function() {
            updateAllocationFromSlider('hedge');
        });
        
        function updateBetReturnVisual(option) {
            const optionA = document.getElementById('returnOptionA');
            const optionB = document.getElementById('returnOptionB');
            const checkboxA = document.getElementById('betReturnA');
            const checkboxB = document.getElementById('betReturnB');
            
            // Update visual styling
            if (checkboxA.checked) {
                optionA.classList.add('selected');
            } else {
                optionA.classList.remove('selected');
            }
            
            if (checkboxB.checked) {
                optionB.classList.add('selected');
            } else {
                optionB.classList.remove('selected');
            }
        }
        
        function updateAllocationFromSlider(changedSlider) {
            if (!currentCalculation) return;
            
            const multiBetSlider = document.getElementById('multiBetSlider');
            const hedgeBetSlider = document.getElementById('hedgeBetSlider');
            
            let multiBetPercentage, hedgeBetPercentage;
            
            if (changedSlider === 'multi') {
                multiBetPercentage = parseInt(multiBetSlider.value);
                hedgeBetPercentage = 100 - multiBetPercentage;
                hedgeBetSlider.value = hedgeBetPercentage;
            } else {
                hedgeBetPercentage = parseInt(hedgeBetSlider.value);
                multiBetPercentage = 100 - hedgeBetPercentage;
                multiBetSlider.value = multiBetPercentage;
            }
            
            // Update the calculation with new percentages
            updateCalculationWithAllocation(multiBetPercentage / 100, hedgeBetPercentage / 100);
        }
        
        function updateCalculationWithAllocation(multiBetRatio, hedgeBetRatio) {
            if (!currentCalculation) return;
            
            const totalCapital = currentCalculation.totalCapital;
            const multiBetStake = totalCapital * multiBetRatio;
            const hedgeStake = totalCapital * hedgeBetRatio;
            
            // Update slider display amounts
            document.getElementById('multiBetSliderAmount').textContent = `$${multiBetStake.toFixed(2)}`;
            document.getElementById('hedgeBetSliderAmount').textContent = `$${hedgeStake.toFixed(2)}`;
            document.getElementById('multiBetPercentage').textContent = `${Math.round(multiBetRatio * 100)}%`;
            document.getElementById('hedgeBetPercentage').textContent = `${Math.round(hedgeBetRatio * 100)}%`;
            
            // Recalculate with new stakes
            const updatedCalculation = {
                ...currentCalculation,
                multiBetStake: multiBetStake,
                hedgeStake: hedgeStake
            };
            
            displayResults(updatedCalculation);
        }
        
        function calculateMultiHedge() {
            const oddsA = parseFloat(document.getElementById('oddsA').value);
            const oddsB = parseFloat(document.getElementById('oddsB').value);
            const totalCapital = parseFloat(document.getElementById('totalCapital').value);
            const betReturnA = document.getElementById('betReturnA').checked;
            const betReturnB = document.getElementById('betReturnB').checked;
            
            if (!oddsA || !oddsB || !totalCapital) {
                alert('Please fill in all fields with valid numbers');
                return;
            }
            
            // Constants
            const maxBetReturn = 50;
            const baseSingleOddsA = 1.8; // Estimated single odds for favourite
            const baseSingleOddsB = 2.5; // Estimated single odds for underdog
            
            // Calculate optimal stake distribution
            let multiBetStake = 0;
            let hedgeStake = 0;
            let multiBetOdds = 0;
            let hedgeOdds = 0;
            let protectedOption = '';
            let actualReturn = 0;
            let initialMultiBetRatio = 0;
            
            if (betReturnA && !betReturnB) {
                // Option A protected - allocate more to multi-bet since it's safer
                initialMultiBetRatio = 0.75;
                multiBetStake = totalCapital * initialMultiBetRatio;
                hedgeStake = totalCapital * (1 - initialMultiBetRatio);
                multiBetOdds = oddsA;
                hedgeOdds = baseSingleOddsB;
                protectedOption = 'A';
                actualReturn = Math.min(multiBetStake, maxBetReturn);
            } else if (betReturnB && !betReturnA) {
                // Option B protected
                initialMultiBetRatio = 0.75;
                multiBetStake = totalCapital * initialMultiBetRatio;
                hedgeStake = totalCapital * (1 - initialMultiBetRatio);
                multiBetOdds = oddsB;
                hedgeOdds = baseSingleOddsA;
                protectedOption = 'B';
                actualReturn = Math.min(multiBetStake, maxBetReturn);
            } else if (betReturnA && betReturnB) {
                alert('Please select only one bet return option or neither');
                return;
            } else {
                // No protection - more conservative split
                initialMultiBetRatio = 0.60;
                multiBetStake = totalCapital * initialMultiBetRatio;
                hedgeStake = totalCapital * (1 - initialMultiBetRatio);
                multiBetOdds = oddsA; // Default to option A
                hedgeOdds = baseSingleOddsB;
                protectedOption = 'none';
            }
            
            // Store current calculation state
            currentCalculation = {
                oddsA, oddsB, totalCapital, betReturnA, betReturnB,
                multiBetOdds, hedgeOdds, protectedOption, maxBetReturn,
                baseSingleOddsA, baseSingleOddsB, actualReturn,
                multiBetStake, hedgeStake
            };
            
            // Set up sliders with initial values
            const multiBetPercentage = Math.round(initialMultiBetRatio * 100);
            const hedgeBetPercentage = 100 - multiBetPercentage;
            
            document.getElementById('multiBetSlider').value = multiBetPercentage;
            document.getElementById('hedgeBetSlider').value = hedgeBetPercentage;
            document.getElementById('multiBetSliderAmount').textContent = `$${multiBetStake.toFixed(2)}`;
            document.getElementById('hedgeBetSliderAmount').textContent = `$${hedgeStake.toFixed(2)}`;
            document.getElementById('multiBetPercentage').textContent = `${multiBetPercentage}%`;
            document.getElementById('hedgeBetPercentage').textContent = `${hedgeBetPercentage}%`;
            
            // Show results and sliders
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('allocationSliders').classList.remove('hidden');
            
            displayResults(currentCalculation);
        }
        
        function displayResults(calc) {
            const { multiBetStake, hedgeStake, multiBetOdds, hedgeOdds, protectedOption, 
                    maxBetReturn, totalCapital, baseSingleOddsA, baseSingleOddsB } = calc;
            
            // Recalculate actualReturn based on current multiBetStake
            const currentActualReturn = (protectedOption !== 'none') ? Math.min(multiBetStake, maxBetReturn) : 0;
            
            // Calculate returns
            const multiBetReturn = multiBetStake * multiBetOdds;
            const hedgeReturn = hedgeStake * hedgeOdds;
            
            // Calculate scenarios
            let scenarios = {};
            
            if (protectedOption === 'A') {
                scenarios = {
                    aWins: {
                        multiBetProfit: multiBetReturn - multiBetStake,
                        hedgeLoss: -hedgeStake,
                        protectionUsed: 0,
                        total: (multiBetReturn - multiBetStake) - hedgeStake
                    },
                    aLoses: {
                        multiBetLoss: -multiBetStake,
                        hedgeProfit: hedgeReturn - hedgeStake,
                        protectionGained: currentActualReturn,
                        total: -multiBetStake + (hedgeReturn - hedgeStake) + currentActualReturn
                    }
                };
            } else if (protectedOption === 'B') {
                scenarios = {
                    bWins: {
                        multiBetProfit: multiBetReturn - multiBetStake,
                        hedgeLoss: -hedgeStake,
                        protectionUsed: 0,
                        total: (multiBetReturn - multiBetStake) - hedgeStake
                    },
                    bLoses: {
                        multiBetLoss: -multiBetStake,
                        hedgeProfit: hedgeReturn - hedgeStake,
                        protectionGained: currentActualReturn,
                        total: -multiBetStake + (hedgeReturn - hedgeStake) + currentActualReturn
                    }
                };
            } else {
                scenarios = {
                    aWins: {
                        multiBetProfit: multiBetReturn - multiBetStake,
                        hedgeLoss: -hedgeStake,
                        protectionUsed: 0,
                        total: (multiBetReturn - multiBetStake) - hedgeStake
                    },
                    bWins: {
                        multiBetLoss: -multiBetStake,
                        hedgeProfit: hedgeReturn - hedgeStake,
                        protectionUsed: 0,
                        total: -multiBetStake + (hedgeReturn - hedgeStake)
                    }
                };
            }
            
            // Display results
            const opportunityDiv = document.getElementById('opportunityStatus');
            const strategyDiv = document.getElementById('strategy');
            const summaryDiv = document.getElementById('summary');
            
            const protectionStatus = (calc.betReturnA || calc.betReturnB) ? 
                `🛡️ Protected Hedging Strategy` : 
                `📊 Standard Hedging Strategy`;
            
            opportunityDiv.innerHTML = `
                <div class="arbitrage-opportunity">
                    ${protectionStatus}
                </div>
            `;
            
            // Strategy cards (update with current stakes)
            let strategyHtml = '';
            if (protectedOption === 'A') {
                strategyHtml = `
                    <div class="strategy-card">
                        <h3>Multi-Bet A (Protected) 🛡️</h3>
                        <div class="bet-amount">${multiBetStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${multiBetOdds} | Return: ${multiBetReturn.toFixed(2)}</div>
                        <div class="potential-return">Protection: ${currentActualReturn.toFixed(2)} if fails</div>
                    </div>
                    <div class="strategy-card">
                        <h3>Hedge Bet B</h3>
                        <div class="bet-amount">${hedgeStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${hedgeOdds} | Return: ${hedgeReturn.toFixed(2)}</div>
                    </div>
                `;
            } else if (protectedOption === 'B') {
                strategyHtml = `
                    <div class="strategy-card">
                        <h3>Multi-Bet B (Protected) 🛡️</h3>
                        <div class="bet-amount">${multiBetStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${multiBetOdds} | Return: ${multiBetReturn.toFixed(2)}</div>
                        <div class="potential-return">Protection: ${currentActualReturn.toFixed(2)} if fails</div>
                    </div>
                    <div class="strategy-card">
                        <h3>Hedge Bet A</h3>
                        <div class="bet-amount">${hedgeStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${hedgeOdds} | Return: ${hedgeReturn.toFixed(2)}</div>
                    </div>
                `;
            } else {
                strategyHtml = `
                    <div class="strategy-card">
                        <h3>Multi-Bet A</h3>
                        <div class="bet-amount">${multiBetStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${multiBetOdds} | Return: ${multiBetReturn.toFixed(2)}</div>
                    </div>
                    <div class="strategy-card">
                        <h3>Hedge Bet B</h3>
                        <div class="bet-amount">${hedgeStake.toFixed(2)}</div>
                        <div class="potential-return">Odds: ${hedgeOdds} | Return: ${hedgeReturn.toFixed(2)}</div>
                    </div>
                `;
            }
            
            strategyDiv.innerHTML = strategyHtml;
            
            // Generate detailed summary
            let summaryHtml = `
                <div class="capital-breakdown">
                    <h4 style="margin-bottom: 15px; color: #333;">💰 Capital Allocation</h4>
                    <div class="capital-grid">
                        <div class="capital-item">
                            <strong>Total Capital</strong>
                            <div class="capital-amount">${totalCapital.toFixed(2)}</div>
                        </div>
                        <div class="capital-item">
                            <strong>Multi-Bet</strong>
                            <div class="capital-amount">${multiBetStake.toFixed(2)}</div>
                        </div>
                        <div class="capital-item">
                            <strong>Hedge Bet</strong>
                            <div class="capital-amount">${hedgeStake.toFixed(2)}</div>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-bottom: 20px; color: #333; text-align: center;">📊 Detailed Profit/Loss Analysis</h4>
            `;
            
            if (protectedOption === 'A') {
                summaryHtml += `
                    <div class="scenario-box scenario-win">
                        <div class="scenario-header">
                            <div class="scenario-title">✅ If Option A Wins</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item positive">
                                    <span class="calc-label">Multi-bet profit</span>
                                    <span class="calc-formula">${multiBetReturn.toFixed(2)} - ${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.aWins.multiBetProfit.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item negative">
                                    <span class="calc-label">Hedge bet loss</span>
                                    <span class="calc-formula">-${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${hedgeStake.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item neutral">
                                    <span class="calc-label">Protection used</span>
                                    <span class="calc-formula">N/A</span>
                                    <span class="calc-result neutral">$0</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Profit</div>
                                <div class="total-amount">${scenarios.aWins.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scenario-box scenario-lose">
                        <div class="scenario-header">
                            <div class="scenario-title">🛡️ If Option A Loses (Protected)</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item negative">
                                    <span class="calc-label">Multi-bet loss</span>
                                    <span class="calc-formula">-${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${multiBetStake.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item positive">
                                    <span class="calc-label">Hedge bet profit</span>
                                    <span class="calc-formula">${hedgeReturn.toFixed(2)} - ${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.aLoses.hedgeProfit.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item positive">
                                    <span class="calc-label">Protection refund ${currentActualReturn === maxBetReturn ? '(capped)' : ''}</span>
                                    <span class="calc-formula">+${currentActualReturn.toFixed(2)}</span>
                                    <span class="calc-result positive">+${currentActualReturn.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Result</div>
                                <div class="total-amount">${scenarios.aLoses.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (protectedOption === 'B') {
                summaryHtml += `
                    <div class="scenario-box scenario-win">
                        <div class="scenario-header">
                            <div class="scenario-title">✅ If Option B Wins</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item positive">
                                    <span class="calc-label">Multi-bet profit</span>
                                    <span class="calc-formula">${multiBetReturn.toFixed(2)} - ${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.bWins.multiBetProfit.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item negative">
                                    <span class="calc-label">Hedge bet loss</span>
                                    <span class="calc-formula">-${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${hedgeStake.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item neutral">
                                    <span class="calc-label">Protection used</span>
                                    <span class="calc-formula">N/A</span>
                                    <span class="calc-result neutral">$0</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Profit</div>
                                <div class="total-amount">${scenarios.bWins.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scenario-box scenario-lose">
                        <div class="scenario-header">
                            <div class="scenario-title">🛡️ If Option B Loses (Protected)</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item negative">
                                    <span class="calc-label">Multi-bet loss</span>
                                    <span class="calc-formula">-${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${multiBetStake.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item positive">
                                    <span class="calc-label">Hedge bet profit</span>
                                    <span class="calc-formula">${hedgeReturn.toFixed(2)} - ${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.bLoses.hedgeProfit.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item positive">
                                    <span class="calc-label">Protection refund ${currentActualReturn === maxBetReturn ? '(capped)' : ''}</span>
                                    <span class="calc-formula">+${currentActualReturn.toFixed(2)}</span>
                                    <span class="calc-result positive">+${currentActualReturn.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Result</div>
                                <div class="total-amount">${scenarios.bLoses.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                summaryHtml += `
                    <div class="scenario-box scenario-win">
                        <div class="scenario-header">
                            <div class="scenario-title">✅ If Option A Wins</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item positive">
                                    <span class="calc-label">Multi-bet profit</span>
                                    <span class="calc-formula">${multiBetReturn.toFixed(2)} - ${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.aWins.multiBetProfit.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item negative">
                                    <span class="calc-label">Hedge bet loss</span>
                                    <span class="calc-formula">-${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${hedgeStake.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Profit</div>
                                <div class="total-amount">${scenarios.aWins.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scenario-box scenario-lose-bad">
                        <div class="scenario-header">
                            <div class="scenario-title">❌ If Option B Wins (No Protection)</div>
                        </div>
                        <div class="scenario-body">
                            <div class="calculation-grid">
                                <div class="calculation-item negative">
                                    <span class="calc-label">Multi-bet loss</span>
                                    <span class="calc-formula">-${multiBetStake.toFixed(2)}</span>
                                    <span class="calc-result negative">-${multiBetStake.toFixed(2)}</span>
                                </div>
                                <div class="calculation-item positive">
                                    <span class="calc-label">Hedge bet profit</span>
                                    <span class="calc-formula">${hedgeReturn.toFixed(2)} - ${hedgeStake.toFixed(2)}</span>
                                    <span class="calc-result positive">+${scenarios.bWins.hedgeProfit.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="total-result">
                                <div class="total-label">Total Result</div>
                                <div class="total-amount">${scenarios.bWins.total.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            summaryHtml += `
                <div style="background: #f0f4f8; padding: 15px; border-radius: 8px; text-align: center; margin-top: 20px;">
                    <p style="color: #666; font-size: 0.9em; margin: 0;">
                        💡 Single leg odds are estimated (A: ${baseSingleOddsA}, B: ${baseSingleOddsB}). Always verify actual odds before placing bets.
                    </p>
                    ${currentActualReturn === maxBetReturn && (multiBetStake > maxBetReturn) ? 
                        '<p style="color: #f59e0b; font-size: 0.85em; margin: 5px 0 0 0;">⚠️ Bet return is capped at $50 despite higher stake</p>' : ''}
                </div>
            `;
            
            summaryDiv.innerHTML = summaryHtml;
        }
        
        // Allow Enter key to calculate
        document.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                calculateMultiHedge();
            }
        });
    </script>
</body>
</html>